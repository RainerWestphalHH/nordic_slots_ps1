<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NORDICSLOTS Leaderboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #121212;
            color: #ffffff;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            min-height: 100vh;
            position: relative;
            padding: 2rem 0;
            overflow: hidden; /* Verhindert horizontales Scrollen durch die Animation */
        }
        @keyframes fall {
            0% { transform: translateY(-100px) rotate(0deg); opacity: 0; }
            10% { opacity: 1; }
            100% { transform: translateY(120vh) rotate(720deg); opacity: 0.5; }
        }
        .dollar-note {
            position: absolute;
            top: -50px;
            font-size: 3rem;
            color: #FFD700;
            animation: fall linear infinite;
            pointer-events: none;
            z-index: -1; /* Fällt hinter dem Inhalt */
        }
        .dollar-note:nth-child(1) { left: 5%; animation-duration: 10s; animation-delay: 0s; }
        .dollar-note:nth-child(2) { left: 15%; animation-duration: 12s; animation-delay: 2s; }
        .dollar-note:nth-child(3) { left: 25%; animation-duration: 9s; animation-delay: 1s; }
        .dollar-note:nth-child(4) { left: 35%; animation-duration: 11s; animation-delay: 3s; }
        .dollar-note:nth-child(5) { left: 45%; animation-duration: 13s; animation-delay: 0.5s; }
        .dollar-note:nth-child(6) { left: 55%; animation-duration: 10.5s; animation-delay: 2.5s; }
        .dollar-note:nth-child(7) { left: 65%; animation-duration: 9.5s; animation-delay: 1.5s; }
        .dollar-note:nth-child(8) { left: 75%; animation-duration: 12s; animation-delay: 3.5s; }
        .dollar-note:nth-child(9) { left: 85%; animation-duration: 8s; animation-delay: 0s; }
        .dollar-note:nth-child(10) { left: 95%; animation-duration: 11s; animation-delay: 2s; }
        .nordicslots-main-title {
            font-size: 2rem; /* Angepasst für HYPE.BET-Stil */
            font-weight: 800;
            color: #FFFFFF;
            text-transform: uppercase;
            letter-spacing: 0.2em;
            margin-bottom: 1rem;
            text-align: center;
        }
        .main-leaderboard-container {
            background-color: transparent; /* Kein separater Hintergrund für den Container */
            max-width: 700px;
            width: 90%;
            text-align: center;
            position: relative;
            display: flex;
            flex-direction: column;
            margin-bottom: 2rem;
        }
        .leaderboard-header h1 {
            font-size: 3.5rem;
            font-weight: 900;
            color: #ffffff;
            letter-spacing: 0.15em;
            text-transform: uppercase;
            margin: 0;
            margin-bottom: 2rem;
        }
        .leaderboard-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        .leaderboard-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: #2c2c2c;
            padding: 0.8rem 1.5rem;
            margin-bottom: 0.75rem;
            border-radius: 9999px; /* Pillenform */
            font-size: 1rem;
            font-weight: 600;
            color: #ffffff;
            transition: background-color 0.2s ease-in-out;
        }
        .leaderboard-item.top-1 {
            background: linear-gradient(to right, #FFD700, #DAA520);
            color: #111;
            font-weight: 800;
        }
        .leaderboard-item.top-2 {
            background-color: #C0C0C0;
            color: #111;
            font-weight: 700;
        }
        .leaderboard-item.top-3 {
            background-color: #CD7F32;
            color: #111;
            font-weight: 700;
        }
        .leaderboard-item .rank-name-container {
            display: flex;
            align-items: center;
            gap: 1rem;
            flex-grow: 1;
        }
        .leaderboard-item .rank {
            font-weight: 800;
        }
        .leaderboard-item .name {
            font-weight: 600;
        }
        .leaderboard-item .xp-prize-container {
            display: flex;
            align-items: center;
            gap: 2rem;
        }
        .leaderboard-item .xp {
            color: #E0E0E0;
            font-weight: 700;
        }
        .leaderboard-item.top-1 .xp,
        .leaderboard-item.top-2 .xp,
        .leaderboard-item.top-3 .xp {
            color: #111;
        }
        .leaderboard-item .prize {
            font-weight: 700;
            color: #FFD700;
        }
        .leaderboard-item.top-1 .prize,
        .leaderboard-item.top-2 .prize,
        .leaderboard-item.top-3 .prize {
            color: #111;
        }
        .leaderboard-footer {
            margin-top: 2rem;
            font-size: 1.3rem;
            font-weight: 800;
            color: #ffffff;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            line-height: 1.3;
            text-align: center;
        }
        @media (max-width: 640px) {
            .leaderboard-header h1 { font-size: 2.5rem; }
            .leaderboard-item { flex-direction: column; align-items: flex-start; padding: 1rem; border-radius: 1rem; }
            .xp-prize-container { width: 100%; justify-content: space-between; margin-top: 0.5rem; }
        }
    </style>
</head>
<body>
    <div class="dollar-note">$</div><div class="dollar-note">$</div><div class="dollar-note">$</div><div class="dollar-note">$</div><div class="dollar-note">$</div><div class="dollar-note">$</div><div class="dollar-note">$</div><div class="dollar-note">$</div><div class="dollar-note">$</div><div class="dollar-note">$</div>

    <div class="nordicslots-main-title">NORDIC.SLOTS</div>
    <div class="main-leaderboard-container">
        <div class="leaderboard-header">
            <h1>LEADERBOARD</h1>
        </div>
        <ul id="leaderboard-list" class="leaderboard-list">
            <li class="loading-message">Lade Leaderboard-Daten...</li>
        </ul>
        <div class="leaderboard-footer">
            GET LUCKY<br>GET HYPED
        </div>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', function() {
        const leaderboardList = document.getElementById('leaderboard-list');

        async function fetchLeaderboardData() {
            try {
                const response = await fetch('/api/leaderboard');
                if (!response.ok) {
                    throw new Error(`Server-Fehler: ${response.statusText} (${response.status})`);
                }
                const data = await response.json();
                if (data && data.summarizedBets && Array.isArray(data.summarizedBets)) {
                    renderLeaderboard(data.summarizedBets);
                } else {
                    renderError('Unerwartetes API-Format.');
                }
            } catch (error) {
                console.error('Fehler beim Abrufen der Leaderboard-Daten:', error);
                renderError(error.message);
            }
        }

        function renderLeaderboard(bets) {
            leaderboardList.innerHTML = '';
            if (bets.length === 0) {
                renderError('Keine Daten für diesen Zeitraum verfügbar.');
                return;
            }

            bets.sort((a, b) => (b.wagered || 0) - (a.wagered || 0));
            const topTen = bets.slice(0, 10);

            topTen.forEach((entry, index) => {
                const rank = index + 1;
                let topClass = '';
                let prizeText = '';

                // Prize mapping based on rank
                const prizes = ['$400', '$300', '$200', '$150', '$100', '$90', '$80', '$70', '$60', '$50'];
                prizeText = prizes[index] || '';

                if (rank === 1) { topClass = 'top-1'; }
                else if (rank === 2) { topClass = 'top-2'; }
                else if (rank === 3) { topClass = 'top-3'; }

                const listItem = document.createElement('li');
                listItem.className = `leaderboard-item ${topClass}`;
                
                const wageredAmount = (entry.wagered / 100).toFixed(0); // Format XP without decimals

                listItem.innerHTML = `
                    <div class="rank-name-container">
                        <span class="rank">${rank}.</span>
                        <span class="name">${entry.user.username}</span>
                    </div>
                    <div class="xp-prize-container">
                        <span class="xp">XP ${wageredAmount}</span>
                        <span class="prize">${prizeText}</span>
                    </div>
                `;
                leaderboardList.appendChild(listItem);
            });
        }

        function renderError(message) {
             leaderboardList.innerHTML = `<li class="error-message" style="text-align: center; color: #ff6b6b;">Fehler beim Laden: ${message}</li>`;
        }
        
        fetchLeaderboardData();
    });
    </script>
</body>
</html>
